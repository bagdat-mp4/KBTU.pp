import psycopg2  # PostgreSQL –¥–µ—Ä–µ–∫“õ–æ—Ä—ã–º–µ–Ω –∂“±–º—ã—Å —ñ—Å—Ç–µ—É–≥–µ –∞—Ä–Ω–∞–ª“ì–∞–Ω psycopg2 –∫—ñ—Ç–∞–ø—Ö–∞–Ω–∞—Å—ã–Ω –∏–º–ø–æ—Ä—Ç—Ç–∞—É
import csv       # CSV —Ñ–∞–π–ª–¥–∞—Ä—ã–º–µ–Ω –∂“±–º—ã—Å —ñ—Å—Ç–µ—É–≥–µ –∞—Ä–Ω–∞–ª“ì–∞–Ω csv –∫—ñ—Ç–∞–ø—Ö–∞–Ω–∞—Å—ã–Ω –∏–º–ø–æ—Ä—Ç—Ç–∞—É
import os        # –û–ø–µ—Ä–∞—Ü–∏—è–ª—ã“õ –∂“Ø–π–µ–º–µ–Ω –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä “Ø—à—ñ–Ω os –∫—ñ—Ç–∞–ø—Ö–∞–Ω–∞—Å—ã–Ω –∏–º–ø–æ—Ä—Ç—Ç–∞—É (–±“±–ª –∫–æ–¥—Ç–∞ —Ç—ñ–∫–µ–ª–µ–π “õ–æ–ª–¥–∞–Ω—ã–ª–º–∞“ì–∞–Ω)

# PostgreSQL-“ì–∞ “õ–æ—Å—ã–ª—É “Ø—à—ñ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä–¥—ñ –æ—Ä–Ω–∞—Ç—É
conn = psycopg2.connect(  # PostgreSQL –¥–µ—Ä–µ–∫“õ–æ—Ä—ã–Ω–∞ “õ–æ—Å—ã–ª—É–¥—ã –±–∞—Å—Ç–∞—É
    database="postgres",  # “ö–æ—Å—ã–ª–∞—Ç—ã–Ω –¥–µ—Ä–µ–∫“õ–æ—Ä–¥—ã“£ –∞—Ç—ã
    user="postgres",      # –î–µ—Ä–µ–∫“õ–æ—Ä“ì–∞ –∫—ñ—Ä—É “Ø—à—ñ–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã –∞—Ç—ã
    password="1111",      # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–Ω—ã“£ “õ“±–ø–∏—è—Å”©–∑—ñ
    host="localhost",     # –î–µ—Ä–µ–∫“õ–æ—Ä —Å–µ—Ä–≤–µ—Ä—ñ –æ—Ä–Ω–∞–ª–∞—Å“õ–∞–Ω —Ö–æ—Å—Ç (–∫–æ–º–ø—å—é—Ç–µ—Ä)
    port="5432"           # –î–µ—Ä–µ–∫“õ–æ—Ä —Å–µ—Ä–≤–µ—Ä—ñ —Ç—ã“£–¥–∞–π—Ç—ã–Ω –ø–æ—Ä—Ç –Ω”©–º—ñ—Ä—ñ
)

cur = conn.cursor()  # –î–µ—Ä–µ–∫“õ–æ—Ä–¥–∞ SQL —Å“±—Ä–∞—É–ª–∞—Ä—ã–Ω –æ—Ä—ã–Ω–¥–∞—É “Ø—à—ñ–Ω –∫—É—Ä—Å–æ—Ä –Ω—ã—Å–∞–Ω—ã–Ω –∂–∞—Å–∞—É

# contacts –∫–µ—Å—Ç–µ—Å—ñ–Ω—ñ“£ –±–∞—Ä –µ–∫–µ–Ω—ñ–Ω —Ç–µ–∫—Å–µ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
def check_table_exists():  # 'check_table_exists' –∞—Ç—Ç—ã —Ñ—É–Ω–∫—Ü–∏—è–Ω—ã –∞–Ω—ã“õ—Ç–∞—É
    try:  # –ú“Ø–º–∫—ñ–Ω –±–æ–ª–∞—Ç—ã–Ω “õ–∞—Ç–µ–ª–µ—Ä–¥—ñ “±—Å—Ç–∞—É “Ø—à—ñ–Ω try –±–ª–æ–≥—ã–Ω –±–∞—Å—Ç–∞—É
        # 'public.contacts' –∫–µ—Å—Ç–µ—Å—ñ–Ω—ñ“£ –±–∞—Ä-–∂–æ“ì—ã–Ω —Ç–µ–∫—Å–µ—Ä–µ—Ç—ñ–Ω SQL —Å“±—Ä–∞—É—ã–Ω –æ—Ä—ã–Ω–¥–∞—É
        cur.execute("SELECT to_regclass('public.contacts');")
        # –°“±—Ä–∞—É –Ω”ô—Ç–∏–∂–µ—Å—ñ–Ω –∞–ª—É (–∫–µ—Å—Ç–µ –±–∞—Ä –±–æ–ª—Å–∞ –∫–µ—Å—Ç–µ –∞—Ç—ã, –∂–æ“õ –±–æ–ª—Å–∞ None)
        result = cur.fetchone()[0]
        if result is None:  # –ï–≥–µ—Ä –Ω”ô—Ç–∏–∂–µ None –±–æ–ª—Å–∞ (–∫–µ—Å—Ç–µ –∂–æ“õ)
            print("–ö–µ—Å—Ç–µ –∂–æ“õ, –æ–Ω—ã –∂–∞—Å–∞—É –∫–µ—Ä–µ–∫.") # –ö–µ—Å—Ç–µ–Ω—ñ“£ –∂–æ“õ –µ–∫–µ–Ω—ñ–Ω —Ö–∞–±–∞—Ä–ª–∞—É
            # –ï–≥–µ—Ä –∫–µ—Å—Ç–µ –∂–æ“õ –±–æ–ª—Å–∞, –æ–Ω—ã –∂–∞—Å–∞—É –∫–µ—Ä–µ–∫
            cur.execute("""  # –ö”©–ø –∂–æ–ª–¥—ã SQL —Å“±—Ä–∞—É—ã–Ω –±–∞—Å—Ç–∞—É
                CREATE TABLE contacts (  # 'contacts' –∞—Ç—Ç—ã –∂–∞“£–∞ –∫–µ—Å—Ç–µ –∂–∞—Å–∞—É
                    id SERIAL PRIMARY KEY,  # –ê–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç“Ø—Ä–¥–µ ”©—Å–µ—Ç—ñ–Ω –±—ñ—Ä–µ–≥–µ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–Ω–µ–≥—ñ–∑–≥—ñ –∫—ñ–ª—Ç)
                    name VARCHAR(100),      # –ê—Ç—ã —Å–∞“õ—Ç–∞–ª–∞—Ç—ã–Ω –±–∞“ì–∞–Ω (100 —Å–∏–º–≤–æ–ª“ì–∞ –¥–µ–π—ñ–Ω)
                    phone VARCHAR(20)       # –¢–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ —Å–∞“õ—Ç–∞–ª–∞—Ç—ã–Ω –±–∞“ì–∞–Ω (20 —Å–∏–º–≤–æ–ª“ì–∞ –¥–µ–π—ñ–Ω)
                );
            """) # SQL —Å“±—Ä–∞—É—ã–Ω –∞—è“õ—Ç–∞—É
            conn.commit()  # ”®–∑–≥–µ—Ä—ñ—Å—Ç–µ—Ä–¥—ñ (–∫–µ—Å—Ç–µ–Ω—ñ –∂–∞—Å–∞—É–¥—ã) –¥–µ—Ä–µ–∫“õ–æ—Ä–¥–∞ —Å–∞“õ—Ç–∞—É
            print("–ö–µ—Å—Ç–µ –∂–∞—Å–∞–ª–¥—ã.") # –ö–µ—Å—Ç–µ–Ω—ñ“£ —Å”ô—Ç—Ç—ñ –∂–∞—Å–∞–ª“ì–∞–Ω—ã–Ω —Ö–∞–±–∞—Ä–ª–∞—É
        else:  # –ï–≥–µ—Ä –∫–µ—Å—Ç–µ –±–∞—Ä –±–æ–ª—Å–∞
            print("–ö–µ—Å—Ç–µ –±–∞—Ä.") # –ö–µ—Å—Ç–µ–Ω—ñ“£ –±–∞—Ä –µ–∫–µ–Ω—ñ–Ω —Ö–∞–±–∞—Ä–ª–∞—É
    except Exception as e:  # –ï–≥–µ—Ä try –±–ª–æ–≥—ã–Ω–¥–∞ “õ–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª—Å–∞
        print(f"“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã: {e}") # “ö–∞—Ç–µ–Ω—ñ“£ –º”ô—Ç—ñ–Ω—ñ–Ω —à—ã“ì–∞—Ä—É
        conn.rollback() # “ö–∞—Ç–µ –±–æ–ª“ì–∞–Ω –∂–∞“ì–¥–∞–π–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–Ω—ã (”©–∑–≥–µ—Ä—ñ—Å—Ç–µ—Ä–¥—ñ) –±–∞—Å—Ç–∞–ø“õ—ã –∫“Ø–π—ñ–Ω–µ “õ–∞–π—Ç–∞—Ä—É

# CSV —Ñ–∞–π–ª–¥–∞–Ω –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –µ–Ω–≥—ñ–∑—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
def insert_from_csv(file_path): # 'insert_from_csv' —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω –∞–Ω—ã“õ—Ç–∞—É (—Ñ–∞–π–ª –∂–æ–ª—ã–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ—Ç—ñ–Ω–¥–µ “õ–∞–±—ã–ª–¥–∞–π–¥—ã)
    try: # –ú“Ø–º–∫—ñ–Ω –±–æ–ª–∞—Ç—ã–Ω “õ–∞—Ç–µ–ª–µ—Ä–¥—ñ “±—Å—Ç–∞—É “Ø—à—ñ–Ω try –±–ª–æ–≥—ã–Ω –±–∞—Å—Ç–∞—É
        # CSV —Ñ–∞–π–ª–¥—ã –∞—à—É ('r' - –æ“õ—É —Ä–µ–∂–∏–º—ñ)
        with open(file_path, 'r') as f: # –§–∞–π–ª–¥—ã 'f' –¥–µ–ø –∞—à—É, 'with' —Ñ–∞–π–ª–¥—ã“£ –∞–≤—Ç–æ–º–∞—Ç—Ç—ã –∂–∞–±—ã–ª—É—ã–Ω “õ–∞–º—Ç–∞–º–∞—Å—ã–∑ –µ—Ç–µ–¥—ñ
            reader = csv.reader(f) # CSV —Ñ–∞–π–ª—ã–Ω –æ“õ—É“ì–∞ –∞—Ä–Ω–∞–ª“ì–∞–Ω reader –Ω—ã—Å–∞–Ω—ã–Ω –∂–∞—Å–∞—É
            # ”ò—Ä –∂–æ–ª–¥—ã –æ“õ—É
            for row in reader: # –§–∞–π–ª–¥–∞“ì—ã ”ô—Ä–±—ñ—Ä –∂–æ–ª–¥—ã ('row') –æ“õ—É —Ü–∏–∫–ª—ñ
                # –ñ–æ–ª–¥–∞ –µ–∫—ñ –±–∞“ì–∞–Ω –±–æ–ª“ì–∞–Ω—ã–Ω —Ç–µ–∫—Å–µ—Ä—É
                if len(row) == 2: # –ï–≥–µ—Ä –∂–æ–ª–¥–∞“ì—ã —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä —Å–∞–Ω—ã 2-–≥–µ —Ç–µ“£ –±–æ–ª—Å–∞
                    # –î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ 'contacts' –∫–µ—Å—Ç–µ—Å—ñ–Ω–µ –µ–Ω–≥—ñ–∑—É (SQL injection-–Ω–∞–Ω “õ–æ—Ä“ì–∞–ª—É “Ø—à—ñ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–ª–µ–Ω–≥–µ–Ω —Å“±—Ä–∞—É)
                    cur.execute("INSERT INTO contacts (name, phone) VALUES (%s, %s)", (row[0], row[1]))
                else: # –ï–≥–µ—Ä –∂–æ–ª–¥–∞“ì—ã —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä —Å–∞–Ω—ã 2-–≥–µ —Ç–µ“£ –±–æ–ª–º–∞—Å–∞
                    print(f"–ï—Å–∫–µ—Ä—Ç—É: {row} –∂–æ–ª—ã –¥“±—Ä—ã—Å –µ–º–µ—Å —Ñ–æ—Ä–º–∞—Ç—Ç–∞.") # –î“±—Ä—ã—Å –µ–º–µ—Å —Ñ–æ—Ä–º–∞—Ç —Ç—É—Ä–∞–ª—ã –µ—Å–∫–µ—Ä—Ç—É —à—ã“ì–∞—Ä—É
            conn.commit()  # –ë–∞—Ä–ª—ã“õ –µ–Ω–≥—ñ–∑—ñ–ª–≥–µ–Ω –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –¥–µ—Ä–µ–∫“õ–æ—Ä–¥–∞ —Å–∞“õ—Ç–∞—É
            print("üì• CSV –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ “õ–æ—Å—ã–ª–¥—ã.") # –î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ“£ —Å”ô—Ç—Ç—ñ “õ–æ—Å—ã–ª“ì–∞–Ω—ã–Ω —Ö–∞–±–∞—Ä–ª–∞—É
    except Exception as e: # –ï–≥–µ—Ä try –±–ª–æ–≥—ã–Ω–¥–∞ “õ–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª—Å–∞
        print(f"“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã: {e}") # “ö–∞—Ç–µ–Ω—ñ“£ –º”ô—Ç—ñ–Ω—ñ–Ω —à—ã“ì–∞—Ä—É
        conn.rollback()  # “ö–∞—Ç–µ –±–æ–ª“ì–∞–Ω –∂–∞“ì–¥–∞–π–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–Ω—ã –±–∞—Å—Ç–∞–ø“õ—ã –∫“Ø–π—ñ–Ω–µ “õ–∞–π—Ç–∞—Ä—É

# “ö–æ–ª–¥–∞–Ω—É—à—ã–¥–∞–Ω –µ–Ω–≥—ñ–∑—É –∞—Ä“õ—ã–ª—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä “õ–æ—Å—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
def insert_from_input(): # 'insert_from_input' —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω –∞–Ω—ã“õ—Ç–∞—É
    try: # –ú“Ø–º–∫—ñ–Ω –±–æ–ª–∞—Ç—ã–Ω “õ–∞—Ç–µ–ª–µ—Ä–¥—ñ “±—Å—Ç–∞—É “Ø—à—ñ–Ω try –±–ª–æ–≥—ã–Ω –±–∞—Å—Ç–∞—É
        name = input("–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑: ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω –∞—Ç—Ç—ã —Å“±—Ä–∞—É
        phone = input("–¢–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ: ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω —Ç–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ–Ω —Å“±—Ä–∞—É
        # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã –µ–Ω–≥—ñ–∑–≥–µ–Ω –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∫–µ—Å—Ç–µ–≥–µ “õ–æ—Å—É
        cur.execute("INSERT INTO contacts (name, phone) VALUES (%s, %s)", (name, phone))
        conn.commit() # ”®–∑–≥–µ—Ä—ñ—Å—Ç—ñ –¥–µ—Ä–µ–∫“õ–æ—Ä–¥–∞ —Å–∞“õ—Ç–∞—É
        print("‚úÖ –ñ–∞“£–∞ –∫–æ–Ω—Ç–∞–∫—Ç “õ–æ—Å—ã–ª–¥—ã.") # –ö–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ“£ —Å”ô—Ç—Ç—ñ “õ–æ—Å—ã–ª“ì–∞–Ω—ã–Ω —Ö–∞–±–∞—Ä–ª–∞—É
    except Exception as e: # –ï–≥–µ—Ä try –±–ª–æ–≥—ã–Ω–¥–∞ “õ–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª—Å–∞
        print(f"“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã: {e}") # “ö–∞—Ç–µ–Ω—ñ“£ –º”ô—Ç—ñ–Ω—ñ–Ω —à—ã“ì–∞—Ä—É
        conn.rollback() # “ö–∞—Ç–µ –±–æ–ª“ì–∞–Ω –∂–∞“ì–¥–∞–π–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–Ω—ã –±–∞—Å—Ç–∞–ø“õ—ã –∫“Ø–π—ñ–Ω–µ “õ–∞–π—Ç–∞—Ä—É

# –ö–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ –∂–∞“£–∞—Ä—Ç—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
def update_contact(): # 'update_contact' —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω –∞–Ω—ã“õ—Ç–∞—É
    try: # –ú“Ø–º–∫—ñ–Ω –±–æ–ª–∞—Ç—ã–Ω “õ–∞—Ç–µ–ª–µ—Ä–¥—ñ “±—Å—Ç–∞—É “Ø—à—ñ–Ω try –±–ª–æ–≥—ã–Ω –±–∞—Å—Ç–∞—É
        contact_id = input("“ö–∞–π ID –∂–∞“£–∞—Ä—Ç–∞—Å—ã“£? ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω –∂–∞“£–∞—Ä—Ç—ã–ª–∞—Ç—ã–Ω –∫–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ“£ ID-—Å—ñ–Ω —Å“±—Ä–∞—É
        new_name = input("–ñ–∞“£–∞ –∞—Ç—ã: ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω –∂–∞“£–∞ –∞—Ç—Ç—ã —Å“±—Ä–∞—É
        new_phone = input("–ñ–∞“£–∞ —Ç–µ–ª–µ—Ñ–æ–Ω: ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω –∂–∞“£–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ–Ω —Å“±—Ä–∞—É
        # –ö”©—Ä—Å–µ—Ç—ñ–ª–≥–µ–Ω ID –±–æ–π—ã–Ω—à–∞ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ“£ –∞—Ç—ã –º–µ–Ω —Ç–µ–ª–µ—Ñ–æ–Ω—ã–Ω –∂–∞“£–∞—Ä—Ç—É
        cur.execute("UPDATE contacts SET name = %s, phone = %s WHERE id = %s", (new_name, new_phone, contact_id))
        conn.commit() # –ñ–∞“£–∞—Ä—Ç—É–¥—ã –¥–µ—Ä–µ–∫“õ–æ—Ä–¥–∞ —Å–∞“õ—Ç–∞—É
        print("‚ôªÔ∏è –ö–æ–Ω—Ç–∞–∫—Ç –∂–∞“£–∞—Ä—Ç—ã–ª–¥—ã.") # –ö–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ“£ —Å”ô—Ç—Ç—ñ –∂–∞“£–∞—Ä—Ç—ã–ª“ì–∞–Ω—ã–Ω —Ö–∞–±–∞—Ä–ª–∞—É
    except Exception as e: # –ï–≥–µ—Ä try –±–ª–æ–≥—ã–Ω–¥–∞ “õ–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª—Å–∞
        print(f"“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã: {e}") # “ö–∞—Ç–µ–Ω—ñ“£ –º”ô—Ç—ñ–Ω—ñ–Ω —à—ã“ì–∞—Ä—É
        conn.rollback() # “ö–∞—Ç–µ –±–æ–ª“ì–∞–Ω –∂–∞“ì–¥–∞–π–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–Ω—ã –±–∞—Å—Ç–∞–ø“õ—ã –∫“Ø–π—ñ–Ω–µ “õ–∞–π—Ç–∞—Ä—É

# –§–∏–ª—å—Ç—Ä–º–µ–Ω —Å“±—Ä–∞–Ω—ã—Å –∂–∞—Å–∞—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
def query_with_filter(): # 'query_with_filter' —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω –∞–Ω—ã“õ—Ç–∞—É
    try: # –ú“Ø–º–∫—ñ–Ω –±–æ–ª–∞—Ç—ã–Ω “õ–∞—Ç–µ–ª–µ—Ä–¥—ñ “±—Å—Ç–∞—É “Ø—à—ñ–Ω try –±–ª–æ–≥—ã–Ω –±–∞—Å—Ç–∞—É
        keyword = input("–ê—Ç—ã –Ω–µ –Ω–æ–º–µ—Ä –±–æ–π—ã–Ω—à–∞ —ñ–∑–¥–µ: ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω —ñ–∑–¥–µ—É –∫—ñ–ª—Ç —Å”©–∑—ñ–Ω —Å“±—Ä–∞—É
        # –ê—Ç –Ω–µ–º–µ—Å–µ —Ç–µ–ª–µ—Ñ–æ–Ω –±–æ–π—ã–Ω—à–∞ —ñ–∑–¥–µ—É (ILIKE - —Ä–µ–≥–∏—Å—Ç—Ä–≥–µ —Ç”ô—É–µ–ª—Å—ñ–∑ —ñ–∑–¥–µ—É, % - –∫–µ–∑ –∫–µ–ª–≥–µ–Ω —Å–∏–º–≤–æ–ª–¥–∞—Ä —Ç—ñ–∑–±–µ–≥—ñ)
        cur.execute("SELECT * FROM contacts WHERE name ILIKE %s OR phone ILIKE %s", (f'%{keyword}%', f'%{keyword}%'))
        rows = cur.fetchall() # –°“±—Ä–∞—É –Ω”ô—Ç–∏–∂–µ—Å—ñ–Ω–¥–µ —Ç–∞–±—ã–ª“ì–∞–Ω –±–∞—Ä–ª—ã“õ –∂–æ–ª–¥–∞—Ä–¥—ã –∞–ª—É
        if rows: # –ï–≥–µ—Ä –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä (–∂–æ–ª–¥–∞—Ä) —Ç–∞–±—ã–ª—Å–∞
            for row in rows: # –¢–∞–±—ã–ª“ì–∞–Ω ”ô—Ä–±—ñ—Ä –∂–æ–ª–¥—ã —Ü–∏–∫–ª–º–µ–Ω ”©—Ç—É
                print(row) # ”ò—Ä–±—ñ—Ä –∂–æ–ª–¥—ã (–∫–æ–Ω—Ç–∞–∫—Ç –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ–Ω) —ç–∫—Ä–∞–Ω“ì–∞ —à—ã“ì–∞—Ä—É
        else: # –ï–≥–µ—Ä –µ—à“õ–∞–Ω–¥–∞–π –∂–æ–ª —Ç–∞–±—ã–ª–º–∞—Å–∞
            print("–ú”ô–ª—ñ–º–µ—Ç —Ç–∞–±—ã–ª–º–∞–¥—ã.") # –ù”ô—Ç–∏–∂–µ –∂–æ“õ –µ–∫–µ–Ω—ñ–Ω —Ö–∞–±–∞—Ä–ª–∞—É
    except Exception as e: # –ï–≥–µ—Ä try –±–ª–æ–≥—ã–Ω–¥–∞ “õ–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª—Å–∞
        print(f"“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã: {e}") # “ö–∞—Ç–µ–Ω—ñ“£ –º”ô—Ç—ñ–Ω—ñ–Ω —à—ã“ì–∞—Ä—É

# –ö–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ ”©—à—ñ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
def delete_contact(): # 'delete_contact' —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω –∞–Ω—ã“õ—Ç–∞—É
    try: # –ú“Ø–º–∫—ñ–Ω –±–æ–ª–∞—Ç—ã–Ω “õ–∞—Ç–µ–ª–µ—Ä–¥—ñ “±—Å—Ç–∞—É “Ø—à—ñ–Ω try –±–ª–æ–≥—ã–Ω –±–∞—Å—Ç–∞—É
        contact_id = input("“ö–∞–π ID ”©—à—ñ—Ä–≥—ñ“£ –∫–µ–ª–µ–¥—ñ? ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω ”©—à—ñ—Ä—ñ–ª–µ—Ç—ñ–Ω –∫–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ“£ ID-—Å—ñ–Ω —Å“±—Ä–∞—É
        # –ö”©—Ä—Å–µ—Ç—ñ–ª–≥–µ–Ω ID –±–æ–π—ã–Ω—à–∞ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ –∫–µ—Å—Ç–µ–¥–µ–Ω ”©—à—ñ—Ä—É (“Ø—Ç—ñ—Ä –±—ñ—Ä —ç–ª–µ–º–µ–Ω—Ç—Ç—ñ –∫–æ—Ä—Ç–µ–∂ –∂–∞—Å–∞—É “Ø—à—ñ–Ω “õ–∞–∂–µ—Ç)
        cur.execute("DELETE FROM contacts WHERE id = %s", (contact_id,))
        conn.commit() # ”®—à—ñ—Ä—É –æ–ø–µ—Ä–∞—Ü–∏—è—Å—ã–Ω –¥–µ—Ä–µ–∫“õ–æ—Ä–¥–∞ —Å–∞“õ—Ç–∞—É
        print("‚ùå –ö–æ–Ω—Ç–∞–∫—Ç ”©—à—ñ—Ä—ñ–ª–¥—ñ.") # –ö–æ–Ω—Ç–∞–∫—Ç—ñ–Ω—ñ“£ —Å”ô—Ç—Ç—ñ ”©—à—ñ—Ä—ñ–ª–≥–µ–Ω—ñ–Ω —Ö–∞–±–∞—Ä–ª–∞—É
    except Exception as e: # –ï–≥–µ—Ä try –±–ª–æ–≥—ã–Ω–¥–∞ “õ–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª—Å–∞
        print(f"“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã: {e}") # “ö–∞—Ç–µ–Ω—ñ“£ –º”ô—Ç—ñ–Ω—ñ–Ω —à—ã“ì–∞—Ä—É
        conn.rollback() # “ö–∞—Ç–µ –±–æ–ª“ì–∞–Ω –∂–∞“ì–¥–∞–π–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–Ω—ã –±–∞—Å—Ç–∞–ø“õ—ã –∫“Ø–π—ñ–Ω–µ “õ–∞–π—Ç–∞—Ä—É

# –ù–µ–≥—ñ–∑–≥—ñ –º–µ–Ω—é
def menu(): # 'menu' —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω –∞–Ω—ã“õ—Ç–∞—É
    run = True # –¶–∏–∫–ª–¥—ñ“£ –∂“±–º—ã—Å—ã–Ω –±–∞—Å“õ–∞—Ä–∞—Ç—ã–Ω –∞–π–Ω—ã–º–∞–ª—ã–Ω—ã 'True' –¥–µ–ø –æ—Ä–Ω–∞—Ç—É
    check_table_exists()  # –ë–∞“ì–¥–∞—Ä–ª–∞–º–∞ –±–∞—Å—Ç–∞–ª“ì–∞–Ω–¥–∞ –∫–µ—Å—Ç–µ–Ω—ñ“£ –±–∞—Ä-–∂–æ“ì—ã–Ω —Ç–µ–∫—Å–µ—Ä—É (–∂”ô–Ω–µ “õ–∞–∂–µ—Ç –±–æ–ª—Å–∞ –∂–∞—Å–∞—É)

    while run: # 'run' –∞–π–Ω—ã–º–∞–ª—ã—Å—ã 'True' –±–æ–ª“ì–∞–Ω—à–∞ —Ü–∏–∫–ª –∂–∞–ª“ì–∞—Å–∞–¥—ã
        print("\nüì± PHONEBOOK MENU:") # –ú–µ–Ω—é —Ç–∞“õ—ã—Ä—ã–±—ã–Ω —à—ã“ì–∞—Ä—É
        print("1 - insert csv")          # 1-—à—ñ –æ–ø—Ü–∏—è–Ω—ã –∫”©—Ä—Å–µ—Ç—É
        print("2 - from input")        # 2-—à—ñ –æ–ø—Ü–∏—è–Ω—ã –∫”©—Ä—Å–µ—Ç—É
        print("3 - update contact")    # 3-—à—ñ –æ–ø—Ü–∏—è–Ω—ã –∫”©—Ä—Å–µ—Ç—É
        print("4 - query with filter") # 4-—à—ñ –æ–ø—Ü–∏—è–Ω—ã –∫”©—Ä—Å–µ—Ç—É
        print("5 - delete contact")    # 5-—à—ñ –æ–ø—Ü–∏—è–Ω—ã –∫”©—Ä—Å–µ—Ç—É
        print("6 - break")             # 6-—à—ã –æ–ø—Ü–∏—è–Ω—ã (—à—ã“ì—É) –∫”©—Ä—Å–µ—Ç—É

        # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–¥–∞–Ω —Ç–∞“£–¥–∞—É —Å“±—Ä–∞—É
        choice = input("–¢–∞“£–¥–∞“£—ã–∑ (1‚Äì6): ") # –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–Ω—ã“£ —Ç–∞“£–¥–∞—É—ã–Ω 'choice' –∞–π–Ω—ã–º–∞–ª—ã—Å—ã–Ω–∞ —Å–∞“õ—Ç–∞—É

        # –¢–∞“£–¥–∞–ª“ì–∞–Ω ”ô—Ä–µ–∫–µ—Ç–∫–µ –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä–¥—ã –æ—Ä—ã–Ω–¥–∞—É
        if choice == '1': # –ï–≥–µ—Ä —Ç–∞“£–¥–∞—É '1' –±–æ–ª—Å–∞
            file_path = input("CSV —Ñ–∞–π–ª–¥—ã“£ —Ç–æ–ª—ã“õ –∂–æ–ª—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑: ") # CSV —Ñ–∞–π–ª –∂–æ–ª—ã–Ω —Å“±—Ä–∞—É
            insert_from_csv(file_path) # CSV-–¥–∞–Ω –µ–Ω–≥—ñ–∑—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω —à–∞“õ—ã—Ä—É

        elif choice == '2': # –ï–≥–µ—Ä —Ç–∞“£–¥–∞—É '2' –±–æ–ª—Å–∞
            insert_from_input() # “ö–æ–ª–º–µ–Ω –µ–Ω–≥—ñ–∑—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω —à–∞“õ—ã—Ä—É

        elif choice == '3': # –ï–≥–µ—Ä —Ç–∞“£–¥–∞—É '3' –±–æ–ª—Å–∞
            update_contact() # –ñ–∞“£–∞—Ä—Ç—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω —à–∞“õ—ã—Ä—É

        elif choice == '4': # –ï–≥–µ—Ä —Ç–∞“£–¥–∞—É '4' –±–æ–ª—Å–∞
            query_with_filter() # –Ü–∑–¥–µ—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω —à–∞“õ—ã—Ä—É

        elif choice == '5': # –ï–≥–µ—Ä —Ç–∞“£–¥–∞—É '5' –±–æ–ª—Å–∞
            delete_contact() # ”®—à—ñ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω —à–∞“õ—ã—Ä—É

        elif choice == '6': # –ï–≥–µ—Ä —Ç–∞“£–¥–∞—É '6' –±–æ–ª—Å–∞
            run = False # –¶–∏–∫–ª–¥—ã —Ç–æ“õ—Ç–∞—Ç—É “Ø—à—ñ–Ω 'run' –∞–π–Ω—ã–º–∞–ª—ã—Å—ã–Ω 'False' –µ—Ç—É
        else: # –ï–≥–µ—Ä —Ç–∞“£–¥–∞—É 1-6 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ –±–æ–ª–º–∞—Å–∞
            print("‚ùó “ö–∞—Ç–µ —Ç–∞“£–¥–∞—É.") # “ö–∞—Ç–µ —Ç–∞“£–¥–∞—É —Ç—É—Ä–∞–ª—ã —Ö–∞–±–∞—Ä–ª–∞–º–∞ —à—ã“ì–∞—Ä—É

# –ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–Ω—ã —ñ—Å–∫–µ “õ–æ—Å—É
menu() # –ù–µ–≥—ñ–∑–≥—ñ –º–µ–Ω—é —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω —à–∞“õ—ã—Ä—É (–±–∞“ì–¥–∞—Ä–ª–∞–º–∞ –æ—Å—ã –∂–µ—Ä–¥–µ–Ω –±–∞—Å—Ç–∞–ª–∞–¥—ã)

# –ö—É—Ä—Å–æ—Ä –º–µ–Ω –±–∞–π–ª–∞–Ω—ã—Å –æ–±—ä–µ–∫—Ç—ñ–ª–µ—Ä—ñ–Ω –∂–∞–±—É (–±–∞“ì–¥–∞—Ä–ª–∞–º–∞ –∞—è“õ—Ç–∞–ª“ì–∞–Ω–¥–∞ —Ä–µ—Å—É—Ä—Å—Ç–∞—Ä–¥—ã –±–æ—Å–∞—Ç—É)
cur.close() # –ö—É—Ä—Å–æ—Ä–¥—ã –∂–∞–±—É
conn.close() # –î–µ—Ä–µ–∫“õ–æ—Ä–º–µ–Ω –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã –∂–∞–±—É